<!doctype html><html lang><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>PineScript入門 - こつこつナレッジ</title><meta name=description content="はじめに PineScriptはトレードのインジケータを作成するための言語です。
独自の言語なので少し癖があります。
この記事では、 Quickstart guide で紹介されているインジケータを解説します。
対象のインジケータのコード //@version=4 study(&#34;MACD&#34;) fast = 12, slow = 26 fastMA = ema(close, fast) slowMA = ema(close, slow) macd = fastMA - slowMA signal = sma(macd, 9) plot(macd, color=color.blue) plot(signal, color=color.orange)  Line 1: //@version=4
この行はコンパイラにスクリプトのバージョンを伝えるコメントです。 Line 2: study(&#34;MACD&#34;)
MACDというチャートの名前を定義しています。
studyはインジケータ、strategyがEAを意味します。 Line 3: fast = 12, slow = 26
2つの変数を定義しています。 Line 4: fastMA = ema(close, fast)
EMA(Exponential Moving Average)を計算した結果をfastMAに代入します。
ema はビルトイン関数です。
closeのシリーズを元に計算し、期間はfast（12）です。 Line 5: slowMA = ema(close, slow)"><meta name=author content><link rel=stylesheet href=https://tech.choihack.com/css/style.359f90443a1563b5eda85db97955980125f82514a22626b5d587f29b836a9318.css><link href=https://tech.choihack.com/custom.css rel=stylesheet><link rel=apple-touch-icon href=https://tech.choihack.com/apple-touch-icon.png><link rel=icon href=https://tech.choihack.com/favicon.ico><meta name=generator content="Hugo 0.85.0"><script async src="https://www.googletagmanager.com/gtag/js?id=G-V3H6ME1VJT"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-V3H6ME1VJT',{anonymize_ip:!1})}</script><meta property="og:title" content="PineScript入門"><meta property="og:description" content="入門"><meta property="og:type" content="article"><meta property="og:url" content="https://tech.choihack.com/post/tradingview/pinescript%E5%85%A5%E9%96%80/"><meta property="article:section" content="post"><meta property="article:published_time" content="2021-07-26T17:13:59+09:00"><meta property="article:modified_time" content="2021-07-26T17:13:59+09:00"></head><header class=header><nav class=nav><h1 class=logo><a href=https://tech.choihack.com/>こつこつナレッジ</a></h1><ul class=menu><li><a href=/>TOP</a></li><li><a href=/post/hugo>Hugo</a></li><li><a href=/post/gas>GAS</a></li><li><a href=/post/tradingview>TradingView</a></li><li><a href=/post/wordpress>WordPress</a></li><li><a href=/post/rubyonrails>RubyOnRails</a></li><li><a href=/search>検索</a></li></ul></nav><nav class=breadcrumb><ul><li><a href=https://tech.choihack.com/>TOP</a></li><li><a href=https://tech.choihack.com/post/>投稿</a></li><li><a href=https://tech.choihack.com/post/tradingview/>TradingView</a></li><li class=active>入門</li></ul></nav></header><body class="dark page"></body><main class=post><article><header class=post-header><h1 class=post-title>PineScript入門</h1><div class=post-meta>2021.07.26</div></header><div class=post-content><h2 id=はじめに>はじめに</h2><p>PineScriptはトレードのインジケータを作成するための言語です。<br>独自の言語なので少し癖があります。<br>この記事では、
<a href=https://www.tradingview.com/pine-script-docs/en/v4/Quickstart_guide.html target=_blank>Quickstart guide</a>
で紹介されているインジケータを解説します。</p><h2 id=対象のインジケータのコード>対象のインジケータのコード</h2><pre><code>//@version=4
study(&quot;MACD&quot;)
fast = 12, slow = 26
fastMA = ema(close, fast)
slowMA = ema(close, slow)
macd = fastMA - slowMA
signal = sma(macd, 9)
plot(macd, color=color.blue)
plot(signal, color=color.orange)
</code></pre><ul><li>Line 1: <code>//@version=4</code><br>この行はコンパイラにスクリプトのバージョンを伝えるコメントです。</li><li>Line 2: <code>study("MACD")</code><br><code>MACD</code>というチャートの名前を定義しています。<br><code>study</code>はインジケータ、<code>strategy</code>がEAを意味します。</li><li>Line 3: <code>fast = 12, slow = 26</code><br>2つの変数を定義しています。</li><li>Line 4: <code>fastMA = ema(close, fast)</code><br>EMA(Exponential Moving Average)を計算した結果をfastMAに代入します。<br><a href=https://jp.tradingview.com/pine-script-reference/#fun_ema target=_blank>ema</a>
はビルトイン関数です。<br>closeのシリーズを元に計算し、期間はfast（12）です。</li><li>Line 5: <code>slowMA = ema(close, slow)</code><br>4行目と同じですが、期間はslow（26）で、slowMAに計算結果を代入します。</li><li>Line 6: <code>macd = fastMA - slowMA</code><br>fastMA と slowMA の差を求めmacd変数に代入します。</li><li>Line 7: <code>signal = sma(macd, 9)</code><br>macdを使って、SMA(Simple Moving Average)を計算し、signal変数に代入します。</li><li>Line 8: <code>plot(macd, color=color.blue)</code>
macd変数を青線でプロットするため、plot関数を使用します。</li><li>Line 9: <code>plot(signal, color=color.orange)</code>
signal変数をオレンジ線でプロットするため、plot関数を使用します。</li></ul><p><code>MACD</code>を実行すると次のようなチャートが見れます。<br><img src=https://www.tradingview.com/pine-script-docs/en/v4/_images/Macd_pine.png alt=MACD></p><h3 id=study-と-strategy>study と strategy</h3><p>strategyはバックテストの実行に使用されます。<br>studyの実行に比べて、strategyはstrategy.*()のような売り・買いの実行をブローカーエミュレーターに対してシミュレートします。</p><p>studyはバックテストには使用できず、ブローカーへの注文もしません。<br>その分少ないリソースで高速に実行できます。</p><p>Strategyはデフォルトでは、履歴バー毎に実行されますが、価格変更毎に実行することも可能です。<br>詳細：
<a href=https://www.tradingview.com/pine-script-docs/en/v4/language/Execution_model.html target=_blank>Execution model</a></p><h3 id=series>Series</h3><p>PineScirptで使用される主なデータ型はSeriesと呼ばれます。<br>これは現在から過去のバーに遡り、各バーに1つの値を持つ連続リストです。<br>これは他の言語で言うところの<code>配列</code>のようなものだと思われがちですが、そう考えるのはよくありません。<br>詳細：
<a href=https://www.tradingview.com/pine-script-docs/en/v4/language/Type_system.html#series target=_blank>Series</a></p><h3 id=pinescriptの実行モデル>PineScriptの実行モデル</h3><p>PineScriptは他の一般的な一度実行されて止まって終わりの言語とは<code>異なって</code>います。<br>各履歴バー毎に一回だけ実行されます。<br>ただし、最新のリアルタイムバーの場合は、価格やボリュームの変更が検知されたタイミングで一度実行されます。<br>また、履歴バーが閉じたタイミングで一度実行されます。</p><h2 id=参考>参考</h2><ul><li><a href=https://jp.tradingview.com/pine-script-reference/ target=_blank>Pineスクリプト言語リファレンスマニュアル</a></li><li><a href=https://www.tradingview.com/blog/ja/category/market-analysis/pine/ target=_blank>Pineスクリプト</a></li><li><a href=https://www.tradingview.com/pine-script-docs/en/v4/index.html target=_blank>Pine Script 4 User Manual</a></li></ul></div><div class=prev-next><a class=next href=https://tech.choihack.com/post/tradingview/%E3%83%9C%E3%83%83%E3%82%AF%E3%82%B9%E6%8F%8F%E7%94%BB%E6%A9%9F%E8%83%BD/><article class=article-card><header class=article-card-header><h2>ボックス描画機能</h2></header><section class=article-card-content><p>はじめに PineScriptにボックス描画機能が追加されました。
この機能ではチャート上に長方形を簡単に書くことができます。 サンプルを踏まえて、PineScriptでの使い方を見ていきます。
サンプル //@version=4 study("Box Example", overlay=true) c_green = color.rgb(33, 150, 243, 80) ll = lowest(10) hh = highest(10) b1 = box(na) if barstate.islast b1 := box.new(bar_index[9], hh, bar_index, ll, bgcolor=c_green, border_style=line.style_dashed) box.delete(b1[1]) //@version=4
バージョン4のPineScriptを使用しています。 study("Box Example", overlay=true)
Box Exampleという名前でインジケータを作成します。
overlay=trueでチャートを重ねて表示します。 c_green = color.rgb(33, 150, 243, 80)
color.rgb(red, green, blue, transp)の文法で色を定義します。
各色は0~255,transpは0(不透明)~100(不可視)です。 ll = lowest(10)
lowestは指定された過去バーの範囲での最安値を意味します。 この場合は過去10本のバーの中での最安値のことです。 hh = highest(10)
lowestと逆で過去10本のバーの中で最高値を意味します。 b1 = box(na)
ifが別のスコープを作成するので、再代入する元になるb1変数を先に空で定義しておきます。 if barstate.islast barstate....</p></section><footer class=article-card-footer><time>2021-07-26</time></footer></article></a></div></article><aside class=aside><h2>目次</h2><nav id=TableOfContents><ul><li><a href=#はじめに>はじめに</a></li><li><a href=#対象のインジケータのコード>対象のインジケータのコード</a><ul><li><a href=#study-と-strategy>study と strategy</a></li><li><a href=#series>Series</a></li><li><a href=#pinescriptの実行モデル>PineScriptの実行モデル</a></li></ul></li><li><a href=#参考>参考</a></li></ul></nav><h2>関連書籍</h2><div class=amazon><a target=_blank href="https://www.amazon.co.jp/dp/4344920791/ref=nosim?tag=tech-choihack0b-22"><img class=amazon-img src="//ws-fe.amazon-adsystem.com/widgets/q?_encoding=UTF8&MarketPlace=JP&ASIN=4344920791&ServiceVersion=20070822&ID=AsinImage&WS=1&Format=_SL350_&tag=tech-choihack0b-22"><section class=amazon-title><p>Amazon</p><p>あなたの FX 投資を成功へと導くTradingView究極ガイド</p></section></a></div><div class="ads side"><h2>おすすめ</h2><iframe src="https://rcm-fe.amazon-adsystem.com/e/cm?o=9&p=21&l=ur1&category=kindleunlimited&banner=178KN9KSS2XDCENS02G2&f=ifr&linkID=81378df7265b0adc45354f106ee4f650&t=tech-choihack-22&tracking_id=tech-choihack-22" width=125 height=125 scrolling=no border=0 marginwidth=0 style=border:none frameborder=0></iframe></div></aside></main></body><div class="ads footer"><iframe src="https://rcm-fe.amazon-adsystem.com/e/cm?o=9&p=48&l=ur1&category=audible&banner=193071V4XXGHG0SQJB02&f=ifr&linkID=2f33203e23e50f0542adbd748b7ba6d8&t=tech-choihack-22&tracking_id=tech-choihack-22" width=728 height=90 scrolling=no border=0 marginwidth=0 style=border:none frameborder=0></iframe></div><footer class=footer><p class=text-center>© - 2021 - こつこつナレッジ</p></footer><script src=https://tech.choihack.com/highlight.min.js></script><script>hljs.initHighlightingOnLoad()</script></html>