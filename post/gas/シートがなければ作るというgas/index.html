<!doctype html><html lang><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>シートがなければ作るというGAS - こつこつナレッジ</title><meta name=description content="きっかけ SpreadsheetでGASを使っていて、自分がよくやるのが月毎にシートを分割すること。
例えば、「2022/01」のシートにはその月の売上をGASで登録する。
「2022/02」になったら、自動でその名前のシートを作って、登録する。
便利だが、GASでシートがなければ作るというのが少し面倒だったので、ここにメモしておく。
やりたいこと 特定のシート名のシートが、そのスプレッドシートに存在するかを確認する。
もしなければ、テンプレートとなるシートをコピーして、シート名を設定する。 さらに、そのシートを一番左に移動する。
戻り値として、シートを返す。
function createSheetIfNotExist(ss, sheetName) { const sheet = ss.getSheetByName(sheetName) if (sheet) return sheet const templateSheet = ss.getSheetByName('原本') const newSheet = ss.insertSheet(sheetName, 1, {template: templateSheet}) return newSheet } insertSheet関数は、第２引数で新規シートの挿入位置を指定できる。
さらに、{template: templateSheet}のように、テンプレートのシートを指定するオプションがある。
まとめ しっかりGoogleのドキュメントを読めば、サクッと解決できた。"><meta name=author content><link rel=stylesheet href=https://tech.choihack.com/css/style.5e3c1b94e7a3169da08d890a552f1f5104fb412b9941455faeaa419605a355f5.css><link href=https://tech.choihack.com/custom.css rel=stylesheet><link rel=apple-touch-icon href=https://tech.choihack.com/apple-touch-icon.png><link rel=icon href=https://tech.choihack.com/favicon.ico><meta name=generator content="Hugo 0.85.0"><script async src="https://www.googletagmanager.com/gtag/js?id=G-V3H6ME1VJT"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-V3H6ME1VJT',{anonymize_ip:!1})}</script><meta property="og:title" content="シートがなければ作るというGAS"><meta property="og:description" content="シートがなければ作るというGAS"><meta property="og:type" content="article"><meta property="og:url" content="https://tech.choihack.com/post/gas/%E3%82%B7%E3%83%BC%E3%83%88%E3%81%8C%E3%81%AA%E3%81%91%E3%82%8C%E3%81%B0%E4%BD%9C%E3%82%8B%E3%81%A8%E3%81%84%E3%81%86gas/"><meta property="article:section" content="post"><meta property="article:published_time" content="2022-08-04T22:32:37+09:00"><meta property="article:modified_time" content="2022-08-04T22:32:37+09:00"><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7379986362181342" crossorigin=anonymous></script><script>window.onload=function(){var a=Array.prototype.slice.call(document.querySelectorAll("pre"),0);a.forEach(function(b){var c=b.firstElementChild,d=c.dataset.lang,e=d?d.split(":")[1]:null,a;e&&(a=document.createElement('div'),a.textContent=e,a.classList.add('code-name'),b.insertBefore(a,c))})}</script></head><header class=header><nav class=nav><h1 class=logo><a href=https://tech.choihack.com/>こつこつナレッジ</a></h1><ul class=menu><li><a href=/>TOP</a></li><li><a href=/post/hugo>Hugo</a></li><li><a href=/post/gas>GAS</a></li><li><a href=/post/tradingview>TradingView</a></li><li><a href=/post/wordpress>WordPress</a></li><li><a href=/post/rubyonrails>RubyOnRails</a></li><li><a href=/post/gcp>GCP</a></li><li><a href=/post/others>雑記</a></li><li><a href=/search>検索</a></li></ul></nav><nav class=breadcrumb><ul><li><a href=https://tech.choihack.com/>TOP</a></li><li><a href=https://tech.choihack.com/post/>投稿</a></li><li><a href=https://tech.choihack.com/post/gas/>GAS</a></li><li class=active>シートがなければ作るというGAS</li></ul></nav></header><body class="dark page"></body><main class=post><article><header class=post-header><h1 class=post-title>シートがなければ作るというGAS</h1><div class=post-meta>2022.08.04</div></header><div class=post-content><h2 id=きっかけ>きっかけ</h2><p>SpreadsheetでGASを使っていて、自分がよくやるのが月毎にシートを分割すること。<br>例えば、「2022/01」のシートにはその月の売上をGASで登録する。<br>「2022/02」になったら、自動でその名前のシートを作って、登録する。<br>便利だが、GASでシートがなければ作るというのが少し面倒だったので、ここにメモしておく。</p><h2 id=やりたいこと>やりたいこと</h2><p>特定のシート名のシートが、そのスプレッドシートに存在するかを確認する。<br>もしなければ、テンプレートとなるシートをコピーして、シート名を設定する。
さらに、そのシートを一番左に移動する。<br>戻り値として、シートを返す。</p><div class=highlight><pre class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=kd>function</span> <span class=nx>createSheetIfNotExist</span><span class=p>(</span><span class=nx>ss</span><span class=p>,</span> <span class=nx>sheetName</span><span class=p>)</span> <span class=p>{</span>
  <span class=kr>const</span> <span class=nx>sheet</span> <span class=o>=</span> <span class=nx>ss</span><span class=p>.</span><span class=nx>getSheetByName</span><span class=p>(</span><span class=nx>sheetName</span><span class=p>)</span>
  <span class=k>if</span> <span class=p>(</span><span class=nx>sheet</span><span class=p>)</span> <span class=k>return</span> <span class=nx>sheet</span>

  <span class=kr>const</span> <span class=nx>templateSheet</span> <span class=o>=</span> <span class=nx>ss</span><span class=p>.</span><span class=nx>getSheetByName</span><span class=p>(</span><span class=s1>&#39;原本&#39;</span><span class=p>)</span>
  <span class=kr>const</span> <span class=nx>newSheet</span> <span class=o>=</span> <span class=nx>ss</span><span class=p>.</span><span class=nx>insertSheet</span><span class=p>(</span><span class=nx>sheetName</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=p>{</span><span class=nx>template</span><span class=o>:</span> <span class=nx>templateSheet</span><span class=p>})</span>
  <span class=k>return</span> <span class=nx>newSheet</span>
<span class=p>}</span>
</code></pre></div><p><code>insertSheet</code>関数は、第２引数で新規シートの挿入位置を指定できる。<br>さらに、<code>{template: templateSheet}</code>のように、テンプレートのシートを指定するオプションがある。</p><h2 id=まとめ>まとめ</h2><p>しっかりGoogleのドキュメントを読めば、サクッと解決できた。</p></div><div class=prev-next><a class=prev href=https://tech.choihack.com/post/gas/spreadsheet%E3%81%AE%E7%94%BB%E5%83%8F%E3%81%8C%E5%8D%B0%E5%88%B7%E3%81%95%E3%82%8C%E3%81%AA%E3%81%84%E5%95%8F%E9%A1%8C%E8%A7%A3%E6%B1%BA/><article class=article-card><header class=article-card-header><h2>Spreadsheetの画像が印刷されない問題解決</h2></header><section class=article-card-content><p>問題 Spreadsheetで画像を表示していて、PDFにして印刷しようとすると画像が表示されなくなることがある。
原因はわかっていないが、推測ではGoogleのサーバーでPDFをレンダリングする際に、一定時間以上経過するとロードされなかった画像は無視してPDFを作成しているような気がする。
つまり、画像を含めてSpreadsheetをPDF化して印刷しようとしても、Googleサーバーのご機嫌次第では表示されなくなる。
これは結構困りもので、人によっては表示されたり、画像によっては表示されたりと解決が難しい。
そもそも画像を表示する方法 よく紹介されている画像を表示する方法としては、Googleドライブ上にファイルを上げて、その画像のファイルIDを取得して、以下のようにIMAGE関数で表示している。
IMAGE("https://drive.google.com/uc?export=download&id={画像のファイルID}")
この方法では、PDFで印刷時に表示されない問題が発生する。
ちなみに、画像は誰でも見れる共有権限にしておかないと、IMAGE関数で表示できないので注意すること。
解決策 以下の方法で表示できた。 IMAGE("https://drive.google.com/thumbnail?id={画像ファイルID}")
おそらくこのURLはGoogleドライブの画像のファイルのサムネイルとして、少し画質が悪いがデータ量が少ないものを表示することになる。
私のケースではこの画質でも十分だったので、問題解決。...</p></section><footer class=article-card-footer><time>2022-08-04</time></footer></article></a></div></article><aside class=aside><h2>目次</h2><nav id=TableOfContents><ul><li><a href=#きっかけ>きっかけ</a></li><li><a href=#やりたいこと>やりたいこと</a></li><li><a href=#まとめ>まとめ</a></li></ul></nav><h2>関連書籍</h2><div class=amazon><p>Amazon</p><a target=_blank href="https://www.amazon.co.jp/dp/B08T1PQ7H8/ref=nosim?tag=tech-choihack03-22"><img class=amazon-img src="//ws-fe.amazon-adsystem.com/widgets/q?_encoding=UTF8&MarketPlace=JP&ASIN=B08T1PQ7H8&ServiceVersion=20070822&ID=AsinImage&WS=1&Format=_SL350_&tag=tech-choihack03-22"><section class=amazon-title><p>Hugoで始める静的サイト構築入門　静的サイトジェネレーターで作る自作サイト (技術の泉シリーズ（NextPublishing）)</p></section></a></div><div class="ads side"><h2>おすすめ</h2><iframe src="https://rcm-fe.amazon-adsystem.com/e/cm?o=9&p=21&l=ur1&category=kindleunlimited&banner=178KN9KSS2XDCENS02G2&f=ifr&linkID=81378df7265b0adc45354f106ee4f650&t=tech-choihack03-22&tracking_id=tech-choihack03-22" width=125 height=125 scrolling=no border=0 marginwidth=0 style=border:none frameborder=0></iframe></div></aside></main></body><footer class=footer><h2>本は聴く時代に！圧倒的おすすめ！</h2><iframe src="https://rcm-fe.amazon-adsystem.com/e/cm?o=9&p=12&l=ur1&category=audible&banner=04TW4TSNDNB96FMCBT82&f=ifr&linkID=4522149f1c95f7594ee105cf8eef4890&t=peperon41410c-22&tracking_id=peperon41410c-22" width=300 height=250 scrolling=no border=0 marginwidth=0 style=border:none frameborder=0></iframe><p class=text-center>© - 2021 - こつこつナレッジ</p></footer><script src=https://tech.choihack.com/highlight.min.js></script><script>hljs.initHighlightingOnLoad()</script></html>