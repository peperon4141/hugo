<!doctype html><html lang><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>Dockerを使ってWordPress環境を瞬作 - こつこつナレッジ</title><meta name=description content="はじめに 色んな技術を勉強する時に、一番厄介なのが環境構築です。
失敗しても捨ててすぐに作りなおせるような環境があれば、勉強が捗りますよね？
そこでdockerを使ってWordPress環境を構築できるようにしました。
docker-composeで一瞬で環境構築 version: '3' services: wp: container_name: wordpress # 名前を付ける image: wordpress:5.4-php7.4-apache # 基となるdockerイメージを設定 ports: # docker内の80ポートを8080ポートとして使用 - 8080:80 depends_on: # dbを待ってから立ち上げる - db environment: # 環境変数を設定する WORDPRESS_DB_HOST: mysql:3306 # mysqlサーバーの3306ポートを指定 WORDPRESS_DB_PASSWORD: password # データベースのパスワード WORDPRESS_DB_NAME: wordpress # データベースの名前 WORDPRESS_DB_USER: wp_user # データベースのユーザー名 volumes: # ホストPCにボリュームをマウントする - ./apache/log:/var/log/apache2 - ./public:/var/www/html db: container_name: mysql image: mysql:5.7 environment: # WordPressの方で指定した設定と同じにしておく必要がある MYSQL_ROOT_PASSWORD: password MYSQL_DATABASE: wordpress MYSQL_USER: wp_user MYSQL_PASSWORD: password volumes: - ."><meta name=author content><link rel=stylesheet href=https://tech.choihack.com/scss/style.ae81328c65b316a170097c8051587efd67425d051e66c75d10ba34c99bfc9521.css><link href=https://tech.choihack.com/custom.css rel=stylesheet><link rel=apple-touch-icon href=https://tech.choihack.com/apple-touch-icon.png><link rel=icon href=https://tech.choihack.com/favicon.ico><meta name=generator content="Hugo 0.85.0"><script async src="https://www.googletagmanager.com/gtag/js?id=G-V3H6ME1VJT"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-V3H6ME1VJT',{anonymize_ip:!1})}</script><meta property="og:title" content="Dockerを使ってWordPress環境を瞬作"><meta property="og:description" content="Dockerを使ってWordPress環境を瞬作"><meta property="og:type" content="article"><meta property="og:url" content="https://tech.choihack.com/post/wordpress/docker%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6wordpress%E7%92%B0%E5%A2%83%E3%82%92%E7%9E%AC%E4%BD%9C/"><meta property="article:section" content="post"><meta property="article:published_time" content="2021-07-29T19:07:24+09:00"><meta property="article:modified_time" content="2021-07-29T19:07:24+09:00"></head><header class=header><nav class=nav><h1 class=logo><a href=https://tech.choihack.com/>こつこつナレッジ</a></h1><ul class=menu><li><a href=/>TOP</a></li><li><a href=/post/hugo>Hugo</a></li><li><a href=/post/gas>GAS</a></li><li><a href=/post/tradingview>TradingView</a></li><li><a href=/post/wordpress>WordPress</a></li><li><a href=/search>検索</a></li></ul></nav><nav class=breadcrumb><ul><li><a href=https://tech.choihack.com/>TOP</a></li><li><a href=https://tech.choihack.com/post/>投稿</a></li><li><a href=https://tech.choihack.com/post/wordpress/>WordPress</a></li><li class=active>Dockerを使ってWordPress環境を瞬作</li></ul></nav></header><body class="dark page"></body><main class=post><article><header class=post-header><h1 class=post-title>Dockerを使ってWordPress環境を瞬作</h1><div class=post-meta>2021.07.29</div></header><div class=post-content><h2 id=はじめに>はじめに</h2><p>色んな技術を勉強する時に、一番厄介なのが環境構築です。<br>失敗しても捨ててすぐに作りなおせるような環境があれば、勉強が捗りますよね？<br>そこでdockerを使ってWordPress環境を構築できるようにしました。</p><h2 id=docker-composeで一瞬で環境構築>docker-composeで一瞬で環境構築</h2><pre><code>version: '3'
services:
  wp:
    container_name: wordpress # 名前を付ける
    image: wordpress:5.4-php7.4-apache # 基となるdockerイメージを設定
    ports: # docker内の80ポートを8080ポートとして使用
      - 8080:80
    depends_on: # dbを待ってから立ち上げる
      - db
    environment: # 環境変数を設定する
      WORDPRESS_DB_HOST: mysql:3306 # mysqlサーバーの3306ポートを指定
      WORDPRESS_DB_PASSWORD: password # データベースのパスワード
      WORDPRESS_DB_NAME: wordpress # データベースの名前
      WORDPRESS_DB_USER: wp_user # データベースのユーザー名
    volumes: # ホストPCにボリュームをマウントする
      - ./apache/log:/var/log/apache2
      - ./public:/var/www/html
  db:
    container_name: mysql 
    image: mysql:5.7
    environment: # WordPressの方で指定した設定と同じにしておく必要がある
      MYSQL_ROOT_PASSWORD: password
      MYSQL_DATABASE: wordpress
      MYSQL_USER: wp_user
      MYSQL_PASSWORD: password
    volumes:
      - ./mysql:/var/lib/mysql
</code></pre><p>docker-compose.ymlというファイルを作成し、上記を書きます。<br>あとは以下のコマンドを実行します。</p><pre><code>docker-compose up
</code></pre><p class=info><code>-d</code>: オプションでバックグラウンドで実行</p><p><a href=http://localhost:8080/ target=_blank>http://localhost:8080/</a>
にアクセスすると、WordPressの設定画面が確認できます。</p><p><img src=/images/WordPress/1.png alt=WordPress設定画面></p><p>あとは画面に従って操作するだけです。</p><h2 id=wordpressの階層を変える>WordPressの階層を変える</h2><p><code>wp:</code> の下の階層に <code>working_dir: /var/www/html/WordPress</code> を追加できます。<br>こうすることで、WordPressディレクトリ以下を基本としてWordPressを起動します。<br>この設定で、サブディレクトリにWordPressがある場合にも対応できます。</p><h2 id=voluems>voluems</h2><pre><code>volumes:
  - ./apache/log:/var/log/apache2
  - ./public:/var/www/html
</code></pre><p>この設定でホストPCにDocker内のファイルをマウントできます。</p><p><code>./apache/log:/var/log/apache2</code>の設定で、WordPressのログが確認できます。<br><code>./public:/var/www/html</code>の設定で、WordPressの中身を確認できます。</p><h2 id=その他コマンド>その他コマンド</h2><h3 id=終了>終了</h3><p>終了するには <code>Ctrl</code> + <code>C</code>です。<br>停止中のコンテナが邪魔な場合は以下で消すことができます。</p><pre><code>docker-compose rm -sf
</code></pre><p class=info><code>-f, --force</code>: オプションで確認なしで実行<br><code>-s, --stop</code>: 必要なら削除前にコンテナを停止する</p><h3 id=コンテナの中に入る>コンテナの中に入る</h3><p>WordPressのDockerコンテナに入るには以下のコマンドです。</p><pre><code>docker exec -it wordpress bash
</code></pre><h3 id=起動中コンテナの確認>起動中コンテナの確認</h3><pre><code>docker ps
</code></pre><p class=info><code>-a, --all</code>: 停止中のコンテナを含めて表示する</p></div><div class=prev-next><a class=prev href=https://tech.choihack.com/post/wordpress/wordpress%E3%81%AE%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E6%A7%8B%E6%88%90%E3%82%92%E7%90%86%E8%A7%A3%E3%81%99%E3%82%8B/><article class=article-card><header class=article-card-header><h2>WordPressのファイル構成を理解する</h2></header><section class=article-card-content><p>はじめに 前回の Dockerを使ってwordpress環境を瞬作 という投稿で、WordPressを立ち上げました。
今回はファイル構成の詳細を見ていきましょう。
ファイル構成 . ├── wp-admin # 管理画面に関するファイル ├── wp-content │ ├── languages │ ├── plugins # プラグインが格納されるディレクトリ │ ├── themes # テーマが格納されるディレクトリ │ └── upgrade └── wp-includes ├── index.php # WordPressが初めに通るファイル ├── wp-config.php # WordPressの設定が書かれているファイル ├── wp-config-sample.php # wp-config.phpの雛形ファイル ├── wp-login.php # ログイン画面のファイル ├── license.txt # ライセンスに関するファイル ├── readme.html # WordPressの概要に関するファイル └── .htaccess # Apacheの設定ファイル ...</p></section><footer class=article-card-footer><time>2021-07-29</time></footer></article></a><a class=next href=https://tech.choihack.com/post/wordpress/mysql%E3%82%92%E8%A6%97%E3%81%84%E3%81%A6%E3%81%BF%E3%82%8B/><article class=article-card><header class=article-card-header><h2>MySQLを覗いてみる</h2></header><section class=article-card-content><p>はじめに 前回の Dockerを使ってwordpress環境を瞬作 という投稿で、WordPressを立ち上げました。
今回は立ち上げたことを前提として、MySQLファイルを覗いていきましょう。
MySQLにログインする まずは、MySQLのDockerコンテナ内に入ります。
docker exec -it mysql bash 入った後、MySQLにログインします。
mysql -u wp_user -ppassword -u: ユーザー名
-p: パスワード
データベースの一覧 $ show databases; +--------------------+ | Database | +--------------------+ | information_schema | | wordpress | +--------------------+ 2 rows in set (0.10 sec) wordpressという名前のデータベースがあることがわかります。
テーブル一覧 use wordpress; でデータベースを指定できます。
テーブル一覧を見てみましょう。
$ show tables; +-----------------------+ | Tables_in_wordpress | +-----------------------+ | wp_commentmeta | | wp_comments | | wp_links | | wp_options | | wp_postmeta | | wp_posts | | wp_term_relationships | | wp_term_taxonomy | | wp_termmeta | | wp_terms | | wp_usermeta | | wp_users | +-----------------------+ 12 rows in set (0....</p></section><footer class=article-card-footer><time>2021-07-29</time></footer></article></a></div></article><aside class=aside><h2>目次</h2><nav id=TableOfContents><ul><li><a href=#はじめに>はじめに</a></li><li><a href=#docker-composeで一瞬で環境構築>docker-composeで一瞬で環境構築</a></li><li><a href=#wordpressの階層を変える>WordPressの階層を変える</a></li><li><a href=#voluems>voluems</a></li><li><a href=#その他コマンド>その他コマンド</a><ul><li><a href=#終了>終了</a></li><li><a href=#コンテナの中に入る>コンテナの中に入る</a></li><li><a href=#起動中コンテナの確認>起動中コンテナの確認</a></li></ul></li></ul></nav><h2>おすすめ書籍</h2><div class=amazon><a target=_blank href="https://www.amazon.co.jp/dp/B00QGBORXI/ref=nosim?tag=tech-choihack-22"><img class=amazon-img src="//ws-fe.amazon-adsystem.com/widgets/q?_encoding=UTF8&MarketPlace=JP&ASIN=B00QGBORXI&ServiceVersion=20070822&ID=AsinImage&WS=1&Format=_SL350_&tag=tech-choihack-22"><section class=amazon-title><p>Amazon</p><p>いちばんやさしいWordPressの教本 人気講師が教える本格Webサイトの作り方 第2版 WordPress 4.x対応 「いちばんやさしい教本」シリーズ</p></section></a></div><h2>商品検索</h2><script type=text/javascript>amzn_assoc_ad_type="responsive_search_widget",amzn_assoc_tracking_id="peperon414105-22",amzn_assoc_marketplace="amazon",amzn_assoc_region="JP",amzn_assoc_placement="",amzn_assoc_search_type="search_widget",amzn_assoc_width="auto",amzn_assoc_height="auto",amzn_assoc_default_search_category="",amzn_assoc_default_search_key="",amzn_assoc_theme="light",amzn_assoc_bg_color="FFFFFF"</script><script src="//z-fe.amazon-adsystem.com/widgets/q?ServiceVersion=20070822&Operation=GetScript&ID=OneJS&WS=1&Marketplace=JP"></script></aside></main></body><div class=ads><iframe src="https://rcm-fe.amazon-adsystem.com/e/cm?o=9&p=48&l=ur1&category=audible&banner=193071V4XXGHG0SQJB02&f=ifr&linkID=2f33203e23e50f0542adbd748b7ba6d8&t=tech-choihack-22&tracking_id=tech-choihack-22" width=728 height=90 scrolling=no border=0 marginwidth=0 style=border:none frameborder=0></iframe></div><footer class=footer><p class=text-center>© - 2021 - こつこつナレッジ</p></footer><script src=https://tech.choihack.com/highlight.min.js></script><script>hljs.initHighlightingOnLoad()</script></html>