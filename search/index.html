<!DOCTYPE html>
<html lang="">
  
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <title> - HUGOまとめ</title>
  
  <meta name="description" content="">
  <meta name="author" content="">
  
  <link href="https://tech.choihack.com/an-old-hope.min.css" rel="stylesheet">
  <link href="https://tech.choihack.com/style.css" rel="stylesheet">
  <link href="https://tech.choihack.com/custom.css" rel="stylesheet">
  
  <link rel="apple-touch-icon" href="https://tech.choihack.com/apple-touch-icon.png">
  <link rel="icon" href="https://tech.choihack.com/favicon.ico">
  <meta name="generator" content="Hugo 0.85.0" />
  
  <link rel="alternate" type="application/rss+xml" href="https://tech.choihack.com/search/index.xml" title="HUGOまとめ" />
  
</head>

  <header class="header">
  
  <nav class="nav">
    <h1 class="logo"><a href="https://tech.choihack.com/">HUGOまとめ</a></h1>
      <ul class="menu">
        <li><a href="/">TOP</a></li>
        <li><a href="/post">投稿</a></li>
        <li><a href="/search">検索</a></li>
      </ul>
  </nav>

  
  <nav class="breadcrumb">
    <ul>
      

    
      <li><a href="https://tech.choihack.com/" >TOP</a></li>

    
      <li class="active">検索</li>
    </ul>
  </nav>
</header>

  <body class="dark list"></body>
    


<script src="data.js"></script>

<main class="main">
  <input type="text" class="search-bar" onInput="search()" autocomplete="off" autofocus placeholder="検索ワード" />
  <div id="result-count"></div>
  <div id="result"></div>
  
  <script>
  function search() {
    var query = document.querySelector('.search-bar').value
    var resultHtmls = searchBy(query)
    updateSearchResults(resultHtmls)
    updateSearchResultCount(resultHtmls.length, data.length)
  }
  
  function searchBy(query) {
    query = query.trim()
    if (query.length < 1) return []

    var resultHtmls = []
    data.forEach(function({url, title, body, date}) {
      var pos = body.search(new RegExp(query, 'i'))
      if (pos != -1) {
        var startPos = pos
        var endPos = pos + query.length
        var html = buildEntryHtml(url, title, body, date, startPos, endPos)
        resultHtmls.push(html)
      }
    })
    return resultHtmls
  }
  
  function buildEntryHtml(url, title, body, date, startPos, endPos) {
    return `
<a href="${url}" style="margin-bottom: 20px;">
  <article class="post-entry">
  <header class="entry-header">
    <h2>${title}</h2>
  </header>
  <section class="entry-content">
    <p>${excerpt(body, startPos, endPos)}...</p>
  </section>
  <footer class="entry-footer">
    <time>${date}</time>
  </footer>
  </article>
</a>
`
  }
  
  
  function excerpt(body, startPos, endPos) {
    return [
      body.substring(startPos - 30, startPos),
      '<b>', body.substring(startPos, endPos), '</b>',
      body.substring(endPos, endPos + 200)
    ].join('')
  }
  
  
  function updateSearchResults(htmls) {
    var el = document.getElementById('result');
    el.innerHTML = htmls.join('');
  }
  
  
  function updateSearchResultCount(searchedResultCount, total) {
    var el = document.getElementById('result-count');
    el.innerHTML = '<b>' + searchedResultCount + '</b> 件見つかりました（' + total + '件中）';
  }

  function getQueryParams() {
    var params = window.location.search.split(/(\?|&)/);
    var parsedParams = {}
    params.forEach(function(param) {
      var [key, value] = param.split('=');
      parsedParams[decodeURIComponent(key)] = decodeURIComponent(value)
    })
    return parsedParams
}

  window.onload = function() {
    var params = getQueryParams()
    document.querySelector('.search-bar').value = params.query || ''
    search()
  }
  </script>
</main>


  </body>

  <footer class="footer">
  <p class="text-center">© - 2021 - Hugoまとめ</p>
</footer>


<script src="https://tech.choihack.com/highlight.min.js"></script>
<script>
  hljs.initHighlightingOnLoad();
</script>

</html>